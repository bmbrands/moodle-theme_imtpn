{"version":3,"file":"sharing_cart_ext.min.js","sources":["../src/sharing_cart_ext.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A javascript module\n *\n */\n\nimport $ from 'jquery';\nimport config from 'core/config';\nimport {addIconToContainerWithPromise} from 'core/loadingicon';\n\nexport const init = () => {\n    document.addEventListener('resource_library_card_rendered', () => {\n        const addToBasketCB = (event) => {\n            if ($) {\n                // Create a spinning icon on the card.\n                const iconPromise = addIconToContainerWithPromise(event.currentTarget);\n                const courseid = document.querySelector('.local-resourcelibrary.block-cards').dataset.parentId;\n                $.post(config.wwwroot + '/blocks/sharing_cart/rest.php', {\n                    \"action\": \"backup\",\n                    \"cmid\": event.target.parentElement.dataset.moduleId,\n                    \"userdata\": false,\n                    \"sesskey\": config.sesskey,\n                    \"courseid\": courseid\n                }).then(() => {\n                    $.post(config.wwwroot + '/blocks/sharing_cart/rest.php',\n                        {\n                            \"action\": \"render_tree\",\n                            \"courseid\": courseid\n                        },\n                        function (response) {\n                            $('.block_sharing_cart .tree').replaceWith($(response));\n                            $.init_item_tree();\n                        }, \"html\").catch((error) => window.console.log(error));\n                    iconPromise.resolve();\n                });\n            }\n        };\n        document.querySelectorAll('.resource-library-activities .sharing-cart-icon').forEach(\n            (element) => {\n                element.onclick = addToBasketCB;\n            }\n        );\n    });\n};\n"],"names":["document","addEventListener","addToBasketCB","event","$","iconPromise","currentTarget","courseid","querySelector","dataset","parentId","post","config","wwwroot","target","parentElement","moduleId","sesskey","then","response","replaceWith","init_item_tree","catch","error","window","console","log","resolve","querySelectorAll","forEach","element","onclick"],"mappings":"0YAwBoB,KAChBA,SAASC,iBAAiB,kCAAkC,WAClDC,cAAiBC,WACfC,gBAAG,OAEGC,aAAc,8CAA8BF,MAAMG,eAClDC,SAAWP,SAASQ,cAAc,sCAAsCC,QAAQC,yBACpFC,KAAKC,gBAAOC,QAAU,gCAAiC,QAC3C,cACFV,MAAMW,OAAOC,cAAcN,QAAQO,mBAC/B,UACDJ,gBAAOK,iBACNV,WACbW,MAAK,qBACFP,KAAKC,gBAAOC,QAAU,gCACpB,QACc,uBACEN,WAEhB,SAAUY,8BACJ,6BAA6BC,aAAY,mBAAED,2BAC3CE,mBACH,QAAQC,OAAOC,OAAUC,OAAOC,QAAQC,IAAIH,SACnDlB,YAAYsB,eAIxB3B,SAAS4B,iBAAiB,mDAAmDC,SACxEC,UACGA,QAAQC,QAAU7B"}